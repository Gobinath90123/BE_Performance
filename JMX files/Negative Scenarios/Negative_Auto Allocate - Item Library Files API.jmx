<?xml version="1.0" encoding="UTF-8"?>
<jmeterTestPlan version="1.2" properties="5.0" jmeter="5.6.3">
  <hashTree>
    <TestPlan guiclass="TestPlanGui" testclass="TestPlan" testname="Auto Allocate - Item Library Files API">
      <elementProp name="TestPlan.user_defined_variables" elementType="Arguments" guiclass="ArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
        <collectionProp name="Arguments.arguments"/>
      </elementProp>
      <boolProp name="TestPlan.functional_mode">false</boolProp>
      <boolProp name="TestPlan.serialize_threadgroups">false</boolProp>
    </TestPlan>
    <hashTree>
      <Arguments guiclass="ArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
        <collectionProp name="Arguments.arguments">
          <elementProp name="THREAD_COUNT" elementType="Argument">
            <stringProp name="Argument.name">THREAD_COUNT</stringProp>
            <stringProp name="Argument.value">1</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc"></stringProp>
          </elementProp>
          <elementProp name="RAMP_UP" elementType="Argument">
            <stringProp name="Argument.name">RAMP_UP</stringProp>
            <stringProp name="Argument.value">1</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="LOOP_COUNT" elementType="Argument">
            <stringProp name="Argument.name">LOOP_COUNT</stringProp>
            <stringProp name="Argument.value">1</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="BASE_URL" elementType="Argument">
            <stringProp name="Argument.name">BASE_URL</stringProp>
            <stringProp name="Argument.value">v10-integration.dev.api.test.benchmarkestimating.com</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Environment</stringProp>
          </elementProp>
          <elementProp name="PROTOCOL" elementType="Argument">
            <stringProp name="Argument.name">PROTOCOL</stringProp>
            <stringProp name="Argument.value">https</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Environment</stringProp>
          </elementProp>
          <elementProp name="API_VERSION" elementType="Argument">
            <stringProp name="Argument.name">API_VERSION</stringProp>
            <stringProp name="Argument.value">v2</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Environment</stringProp>
          </elementProp>
          <elementProp name="USERNAME" elementType="Argument">
            <stringProp name="Argument.name">USERNAME</stringProp>
            <stringProp name="Argument.value">${__P(username,vijaym)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Auth</stringProp>
          </elementProp>
          <elementProp name="PASSWORD" elementType="Argument">
            <stringProp name="Argument.name">PASSWORD</stringProp>
            <stringProp name="Argument.value">${__P(password,Welcome123)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Auth</stringProp>
          </elementProp>
          <elementProp name="PORTFOLIO_TITLE" elementType="Argument">
            <stringProp name="Argument.name">PORTFOLIO_TITLE</stringProp>
            <stringProp name="Argument.value">Karan</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Portfolio</stringProp>
          </elementProp>
          <elementProp name="PROGRAMME_TITLE" elementType="Argument">
            <stringProp name="Argument.name">PROGRAMME_TITLE</stringProp>
            <stringProp name="Argument.value">kl</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Programme </stringProp>
          </elementProp>
          <elementProp name="PROJECT_TITLE" elementType="Argument">
            <stringProp name="Argument.name">PROJECT_TITLE</stringProp>
            <stringProp name="Argument.value">New Test Project</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Project</stringProp>
          </elementProp>
          <elementProp name="PROJECT_DESC" elementType="Argument">
            <stringProp name="Argument.name">PROJECT_DESC</stringProp>
            <stringProp name="Argument.value">Project_NH</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Project</stringProp>
          </elementProp>
          <elementProp name="ESTIMATE_TITLE" elementType="Argument">
            <stringProp name="Argument.name">ESTIMATE_TITLE</stringProp>
            <stringProp name="Argument.value">RETY</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="childIndex" elementType="Argument">
            <stringProp name="Argument.name">childIndex</stringProp>
            <stringProp name="Argument.value">1</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="ITEM_LIBRARY_COUNT" elementType="Argument">
            <stringProp name="Argument.name">ITEM_LIBRARY_COUNT</stringProp>
            <stringProp name="Argument.value">1</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
        </collectionProp>
      </Arguments>
      <hashTree/>
      <ConfigTestElement guiclass="HttpDefaultsGui" testclass="ConfigTestElement" testname="HTTP Defaults" enabled="true">
        <stringProp name="HTTPSampler.domain">${BASE_URL}</stringProp>
        <stringProp name="HTTPSampler.protocol">${PROTOCOL}</stringProp>
        <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
          <collectionProp name="Arguments.arguments"/>
        </elementProp>
        <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
      </ConfigTestElement>
      <hashTree/>
      <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Headers" enabled="true">
        <collectionProp name="HeaderManager.headers">
          <elementProp name="" elementType="Header">
            <stringProp name="Header.name">Content-Type</stringProp>
            <stringProp name="Header.value">application/json</stringProp>
          </elementProp>
          <elementProp name="" elementType="Header">
            <stringProp name="Header.name">Accept</stringProp>
            <stringProp name="Header.value">application/json</stringProp>
          </elementProp>
        </collectionProp>
      </HeaderManager>
      <hashTree/>
      <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="Negative Scenario Auto Allocate - Item Library Files API" enabled="true">
        <intProp name="ThreadGroup.num_threads">1</intProp>
        <intProp name="ThreadGroup.ramp_time">1</intProp>
        <boolProp name="ThreadGroup.same_user_on_next_iteration">true</boolProp>
        <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller">
          <stringProp name="LoopController.loops">1</stringProp>
          <boolProp name="LoopController.continue_forever">false</boolProp>
        </elementProp>
      </ThreadGroup>
      <hashTree>
        <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="01_Authentication" enabled="true"/>
        <hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Login_API" enabled="true">
            <stringProp name="HTTPSampler.path">/api/v2/auth/login</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
    &quot;name&quot;: &quot;${USERNAME}&quot;,&#xd;
    &quot;password&quot;: &quot;${PASSWORD}&quot;,&#xd;
    &quot;userType&quot;: &quot;string&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="Extract and Log Auth Token " enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper

// === 1. Capture Request Payload ===
def username = vars.get(&quot;USERNAME&quot;) ?: &quot;USERNAME_NOT_SET&quot;
def password = vars.get(&quot;PASSWORD&quot;) ?: &quot;PASSWORD_NOT_SET&quot;

// === 2. Extract response and parse ===
def response = prev.getResponseDataAsString()
def authToken = &quot;AUTH_TOKEN_NOT_SET&quot;

if (response) {
    try {
        def json = new JsonSlurper().parseText(response)
        def extractedToken = json?.data
        if (extractedToken) {
            authToken = extractedToken.toString()
            vars.put(&quot;authToken&quot;, authToken)
        } else {
            log.warn(&quot;⚠️ authToken missing in response&quot;)
        }
    } catch (Exception e) {
        log.error(&quot;❌ JSON parse error&quot;, e)
    }
} else {
    log.warn(&quot;❗ Response is empty&quot;)
}

// === 3. Log and show output ===
def payloadLog = &quot;&quot;&quot;
====================== RUNTIME DEBUG INFO ======================

&gt;&gt;&gt; REQUEST PAYLOAD:
USERNAME : $username
PASSWORD : $password

&gt;&gt;&gt; RESPONSE DATA:
Extracted authToken :
$authToken

================================================================
&quot;&quot;&quot;

// Print to JMeter log and View Results Tree
log.info(payloadLog)
prev.setSampleLabel(&quot;Log Payload + Token&quot;)
prev.setResponseData(payloadLog, &quot;UTF-8&quot;)
</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
        </hashTree>
        <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Auto Allocate Item Library Items files" enabled="true"/>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Authorization</stringProp>
                <stringProp name="Header.value">Bearer ${authToken}</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Expand till Project" enabled="true"/>
          <hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Get Portfolio List" enabled="true">
              <stringProp name="HTTPSampler.path">/api/v2/project-composition/get</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
    &quot;leftValue&quot;: 1,&#xd;
    &quot;offset&quot;: 0,&#xd;
    &quot;recordsPerPage&quot;: 450,&#xd;
    &quot;aggregateLevel&quot;: &quot;portfolio&quot;,&#xd;
    &quot;expandedList&quot;: [],&#xd;
    &quot;portfolioId&quot;: 0,&#xd;
    &quot;programmeId&quot;: 0,&#xd;
    &quot;schemeId&quot;: 0&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">//import groovy.json.JsonSlurper
//
//// Optional: Controller and Request names for display
//def controllerName = &quot;Step 1 - Get Project&quot;
//def requestName = &quot;Get Portfolio List&quot;
//
//// Step 1: Parse JSON response
//def response = prev.getResponseDataAsString()
//def json = new JsonSlurper().parseText(response)
//
//// Step 2: Get portfolio title from JMeter variable
//def portfolioTitle = vars.get(&quot;PORTFOLIO_TITLE&quot;)
//
//// Step 3: Find matching portfolioId
//def portfolioId = json.data.find { it.title == portfolioTitle }?.id
//
//// Step 4: Save the value and log
//if (portfolioId != null) {
//    vars.put(&quot;portfolioId&quot;, portfolioId.toString())
//
//    // Structured log output
//    log.info(&quot;================================================================&quot;)
//    log.info(&quot;Controller   : ${controllerName}&quot;)
//    log.info(&quot;Request Name : ${requestName}&quot;)
//    log.info(&quot;================================================================&quot;)
//    log.info(&quot;Extracted Output&quot;)
//    log.info(&quot;----------------------------------------------------------------&quot;)
//    log.info(&quot;PORTFOLIO_TITLE  = ${portfolioTitle}&quot;)
//    log.info(&quot;portfolioId      = ${portfolioId}&quot;)
//    log.info(&quot;================================================================&quot;)
//} else {
//    log.warn(&quot;❌ No matching portfolioId found for PORTFOLIO_TITLE = &apos;${portfolioTitle}&apos;&quot;)
//    SampleResult.setSuccessful(false)
//}

import groovy.json.JsonSlurper

// Optional: Controller and Request names for display
def controllerName = &quot;Step 1 - Get Project&quot;
def requestName = &quot;Get Portfolio List&quot;

// Step 1: Parse JSON response
def response = prev.getResponseDataAsString()
def json = new JsonSlurper().parseText(response)

// Step 2: Get portfolio title from JMeter variable
def portfolioTitle = vars.get(&quot;PORTFOLIO_TITLE&quot;) ?: &quot;PORTFOLIO_TITLE_NOT_SET&quot;

// Step 3: Find matching portfolioId
def portfolioId = json.data.find { it.title == portfolioTitle }?.id

// Step 4: Save the value and log
if (portfolioId != null) {
    vars.put(&quot;portfolioId&quot;, portfolioId.toString())

    // GUI mode logging
    log.info(&quot;================================================================&quot;)
    log.info(&quot;Controller   : ${controllerName}&quot;)
    log.info(&quot;Request Name : ${requestName}&quot;)
    log.info(&quot;================================================================&quot;)
    log.info(&quot;Extracted Output&quot;)
    log.info(&quot;----------------------------------------------------------------&quot;)
    log.info(&quot;PORTFOLIO_TITLE  = ${portfolioTitle}&quot;)
    log.info(&quot;portfolioId      = ${portfolioId}&quot;)
    log.info(&quot;================================================================&quot;)

    // Console (non-GUI) logging
    System.out.println(&quot;================================================================&quot;)
    System.out.println(&quot;Controller   : ${controllerName}&quot;)
    System.out.println(&quot;Request Name : ${requestName}&quot;)
    System.out.println(&quot;================================================================&quot;)
    System.out.println(&quot;Extracted Output&quot;)
    System.out.println(&quot;----------------------------------------------------------------&quot;)
    System.out.println(&quot;PORTFOLIO_TITLE  = ${portfolioTitle}&quot;)
    System.out.println(&quot;portfolioId      = ${portfolioId}&quot;)
    System.out.println(&quot;================================================================&quot;)

} else {
    log.warn(&quot;❌ No matching portfolioId found for PORTFOLIO_TITLE = &apos;${portfolioTitle}&apos;&quot;)
    System.out.println(&quot;❌ No matching portfolioId found for PORTFOLIO_TITLE = &apos;${portfolioTitle}&apos;&quot;)
    SampleResult.setSuccessful(false)
}

</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Get Portfolio" enabled="true">
              <stringProp name="HTTPSampler.path">/api/v2/project-composition/get</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
    &quot;leftValue&quot;: 1,&#xd;
    &quot;offset&quot;: 0,&#xd;
    &quot;recordsPerPage&quot;: 450,&#xd;
    &quot;aggregateLevel&quot;: &quot;portfolio&quot;,&#xd;
    &quot;expandedList&quot;: [${portfolioId}],&#xd;
    &quot;portfolioId&quot;: 0,&#xd;
    &quot;programmeId&quot;: 0,&#xd;
    &quot;schemeId&quot;: 0&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">//import groovy.json.JsonSlurper
//
//// === Metadata for better log traceability ===
//def controllerName = &quot;Step 2 - Get Project&quot;
//def requestName = &quot;Get Programme ID&quot;
//
//// === Step 1: Parse the response ===
//def response = prev.getResponseDataAsString()
//def json = new JsonSlurper().parseText(response)
//
//// === Step 2: Get programme title from JMeter variable ===
//def programmeTitleToFind = vars.get(&quot;PROGRAMME_TITLE&quot;)
//
//// === Step 3: Search for matching programme ID ===
//def programmeId = json.data.find { it.title == programmeTitleToFind }?.id
//
//// === Step 4: Save and log result ===
//if (programmeId != null) {
//    vars.put(&quot;programmeId&quot;, programmeId.toString())
//
//    // Structured success log
//    log.info(&quot;================================================================&quot;)
//    log.info(&quot;Controller   : ${controllerName}&quot;)
//    log.info(&quot;Request Name : ${requestName}&quot;)
//    log.info(&quot;================================================================&quot;)
//    log.info(&quot;Extracted Output&quot;)
//    log.info(&quot;----------------------------------------------------------------&quot;)
//    log.info(&quot;PROGRAMME_TITLE = ${programmeTitleToFind}&quot;)
//    log.info(&quot;programmeId     = ${programmeId}&quot;)
//    log.info(&quot;================================================================&quot;)
//} else {
//    def errorMsg = &quot;❌ No matching programmeId found for PROGRAMME_TITLE = &apos;${programmeTitleToFind}&apos;&quot;
//    log.error(errorMsg)
//    SampleResult.setSuccessful(false) // Mark sampler as failed
//    prev.setResponseData(errorMsg, &quot;UTF-8&quot;)
//}

import groovy.json.JsonSlurper

// === Metadata for better log traceability ===
def controllerName = &quot;Step 2 - Get Project&quot;
def requestName = &quot;Get Programme ID&quot;

// === Step 1: Parse the response ===
def response = prev.getResponseDataAsString()
def json = new JsonSlurper().parseText(response)

// === Step 2: Get programme title from JMeter variable ===
def programmeTitleToFind = vars.get(&quot;PROGRAMME_TITLE&quot;) ?: &quot;NOT_SET&quot;

// === Step 3: Search for matching programme ID ===
def programmeId = json.data.find { it.title == programmeTitleToFind }?.id

// === Step 4: Save and log result ===
if (programmeId != null) {
    vars.put(&quot;programmeId&quot;, programmeId.toString())

    // === GUI Mode Logging ===
    log.info(&quot;================================================================&quot;)
    log.info(&quot;Controller   : ${controllerName}&quot;)
    log.info(&quot;Request Name : ${requestName}&quot;)
    log.info(&quot;================================================================&quot;)
    log.info(&quot;Extracted Output&quot;)
    log.info(&quot;----------------------------------------------------------------&quot;)
    log.info(&quot;PROGRAMME_TITLE = ${programmeTitleToFind}&quot;)
    log.info(&quot;programmeId     = ${programmeId}&quot;)
    log.info(&quot;================================================================&quot;)

    // === Console (Non-GUI) Mode Logging ===
    System.out.println(&quot;================================================================&quot;)
    System.out.println(&quot;Controller   : ${controllerName}&quot;)
    System.out.println(&quot;Request Name : ${requestName}&quot;)
    System.out.println(&quot;================================================================&quot;)
    System.out.println(&quot;Extracted Output&quot;)
    System.out.println(&quot;----------------------------------------------------------------&quot;)
    System.out.println(&quot;PROGRAMME_TITLE = ${programmeTitleToFind}&quot;)
    System.out.println(&quot;programmeId     = ${programmeId}&quot;)
    System.out.println(&quot;================================================================&quot;)

} else {
    def errorMsg = &quot;❌ No matching programmeId found for PROGRAMME_TITLE = &apos;${programmeTitleToFind}&apos;&quot;

    // === GUI Mode Error Log ===
    log.error(errorMsg)

    // === Console (Non-GUI) Mode Error Log ===
    System.err.println(errorMsg)

    SampleResult.setSuccessful(false) // Mark sampler as failed
    prev.setResponseData(errorMsg, &quot;UTF-8&quot;)
}

</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Get Programe" enabled="true">
              <stringProp name="HTTPSampler.path">/api/v2/project-composition/get</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
    &quot;leftValue&quot;: 1,&#xd;
    &quot;offset&quot;: 0,&#xd;
    &quot;recordsPerPage&quot;: 450,&#xd;
    &quot;aggregateLevel&quot;: &quot;programme&quot;,&#xd;
    &quot;expandedList&quot;: [${portfolioId},${programmeId}],&#xd;
    &quot;portfolioId&quot;: 0,&#xd;
    &quot;programmeId&quot;: 0,&#xd;
    &quot;schemeId&quot;: 0&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">//import groovy.json.JsonSlurper
//
//// === Metadata for better log traceability ===
//def controllerName = &quot;Step 3 - Get Project&quot;
//def requestName = &quot;Get Project ID&quot;
//
//// === Step 1: Parse the JSON response ===
//def response = prev.getResponseDataAsString()
//def json = new JsonSlurper().parseText(response)
//
//// === Step 2: Get Project Title from JMeter variable ===
//def projectTitleToFind = vars.get(&quot;PROJECT_TITLE&quot;)
//
//// === Step 3: Find matching Project ID ===
//def projectId = json.data.find { it.title == projectTitleToFind }?.id
//
//// === Step 4: Save the result and log output ===
//if (projectId != null) {
//    vars.put(&quot;projectId&quot;, projectId.toString())
//
//    log.info(&quot;================================================================&quot;)
//    log.info(&quot;Controller   : ${controllerName}&quot;)
//    log.info(&quot;Request Name : ${requestName}&quot;)
//    log.info(&quot;================================================================&quot;)
//    log.info(&quot;Extracted Output&quot;)
//    log.info(&quot;----------------------------------------------------------------&quot;)
//    log.info(&quot;PROJECT_TITLE  = ${projectTitleToFind}&quot;)
//    log.info(&quot;projectId      = ${projectId}&quot;)
//    log.info(&quot;================================================================&quot;)
//} else {
//    def errorMsg = &quot;❌ No matching projectId found for PROJECT_TITLE = &apos;${projectTitleToFind}&apos;&quot;
//    log.error(errorMsg)
//    SampleResult.setSuccessful(false)
//    prev.setResponseData(errorMsg, &quot;UTF-8&quot;)
//}

import groovy.json.JsonSlurper

// === Metadata for better log traceability ===
def controllerName = &quot;Step 3 - Get Project&quot;
def requestName = &quot;Get Project ID&quot;

// === Step 1: Parse the JSON response ===
def response = prev.getResponseDataAsString()
def json = new JsonSlurper().parseText(response)

// === Step 2: Get Project Title from JMeter variable ===
def projectTitleToFind = vars.get(&quot;PROJECT_TITLE&quot;)

// === Step 3: Find matching Project ID ===
def projectId = json.data.find { it.title == projectTitleToFind }?.id

// === Step 4: Save the result and log output ===
if (projectId != null) {
    vars.put(&quot;projectId&quot;, projectId.toString())

    // ✅ GUI mode log
    log.info(&quot;================================================================&quot;)
    log.info(&quot;Controller   : ${controllerName}&quot;)
    log.info(&quot;Request Name : ${requestName}&quot;)
    log.info(&quot;================================================================&quot;)
    log.info(&quot;Extracted Output&quot;)
    log.info(&quot;----------------------------------------------------------------&quot;)
    log.info(&quot;PROJECT_TITLE  = ${projectTitleToFind}&quot;)
    log.info(&quot;projectId      = ${projectId}&quot;)
    log.info(&quot;================================================================&quot;)

    // ✅ Console (non-GUI) mode log
    System.out.println(&quot;================================================================&quot;)
    System.out.println(&quot;Controller   : ${controllerName}&quot;)
    System.out.println(&quot;Request Name : ${requestName}&quot;)
    System.out.println(&quot;================================================================&quot;)
    System.out.println(&quot;Extracted Output&quot;)
    System.out.println(&quot;----------------------------------------------------------------&quot;)
    System.out.println(&quot;PROJECT_TITLE  = ${projectTitleToFind}&quot;)
    System.out.println(&quot;projectId      = ${projectId}&quot;)
    System.out.println(&quot;================================================================&quot;)

} else {
    def errorMsg = &quot;❌ No matching projectId found for PROJECT_TITLE = &apos;${projectTitleToFind}&apos;&quot;
    log.error(errorMsg)                       // GUI error log
    System.err.println(errorMsg)              // Console error log
    SampleResult.setSuccessful(false)         // Mark sampler as failed
    prev.setResponseData(errorMsg, &quot;UTF-8&quot;)
}

</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Get Project" enabled="true">
              <stringProp name="HTTPSampler.path">/api/v2/project-composition/get/estimates/${projectId}</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">GET</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
                <collectionProp name="Arguments.arguments"/>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">//import groovy.json.JsonSlurper
//
//// === Metadata for structured logging ===
//def controllerName = &quot;Step 4 - Fetch Estimate by Title&quot;
//def requestName = &quot;Get Project &amp; Details ID from Estimate Title&quot;
//
//// === Step 1: Parse the JSON response ===
//def response = prev.getResponseDataAsString()
//def json = new JsonSlurper().parseText(response)
//
//// === Step 2: Get Estimate Title from JMeter variable ===
//def estimateTitleToFind = vars.get(&quot;ESTIMATE_TITLE&quot;)?.trim()
//log.info(&quot;Looking for estimate title: &apos;${estimateTitleToFind}&apos;&quot;)
//
//
//// === Step 3: Search with Logging ===
//def match = null
//json.data.each { item -&gt;
//    def title = item.projectTitle?.trim()
//    log.info(&quot;Comparing with title: &apos;${title}&apos;&quot;)
//    if (title == estimateTitleToFind) {
//        match = item
//        log.info(&quot;✅ Match found!&quot;)
//    }
//}
//
////// === Step 3: Find matching object ===
////def match = json.data.find { it.projectTitle?.trim() == estimateTitleToFind }
////
//
//if (match) {
//    def projectId = match.projectId?.toString()
//    def projectDetailsId = match.projectDetailsId?.toString()
//    def projectCompositionLinkId = match.projectCompositionLinkId?.toString()
//    def projectQuoteNo           = match.projectQuoteNo?.toString()
//    def title                    = match.projectTitle?.toString()
//    def parentId                 = match.parentId?.toString()
//    def childEstimateCount       = match.childEstimateCount?.toString()
//
//    vars.put(&quot;projectIds&quot;, projectId)
//    vars.put(&quot;projectCompositionLinkId&quot;, projectCompositionLinkId)
//    vars.put(&quot;projectQuoteNo&quot;, projectQuoteNo)
//    vars.put(&quot;estimate_title&quot;, title)
//    vars.put(&quot;parentId&quot;, parentId)
//    vars.put(&quot;childEstimateCount&quot;, childEstimateCount)
//
//    log.info(&quot;================================================================&quot;)
//    log.info(&quot;Controller   : ${controllerName}&quot;)
//    log.info(&quot;Request Name : ${requestName}&quot;)
//    log.info(&quot;================================================================&quot;)
//    log.info(&quot;Extracted Output&quot;)
//    log.info(&quot;----------------------------------------------------------------&quot;)
//    log.info(&quot;ESTIMATE_TITLE         = ${estimateTitleToFind}&quot;)
//    log.info(&quot;Project ID             = ${projectId}&quot;)
//    log.info(&quot;Project Details ID     = ${projectDetailsId}&quot;)
//    log.info(&quot;Project Composition ID = ${projectCompositionLinkId}&quot;)
//    log.info(&quot;Project Quote No       = ${projectQuoteNo}&quot;)
//    log.info(&quot;Parent ID              = ${parentId}&quot;)
//    log.info(&quot;Child Estimate Count   = ${childEstimateCount}&quot;)
//    log.info(&quot;================================================================&quot;)
//
//} else {
//    def errorMsg = &quot;❌ No matching project found for ESTIMATE_TITLE = &apos;${estimateTitleToFind}&apos;&quot;
//    log.error(errorMsg)
//    prev.setSuccessful(false) // ✅ Correct for PostProcessor
//    prev.setResponseData(errorMsg, &quot;UTF-8&quot;)
//}

import groovy.json.JsonSlurper

// === Metadata for structured logging ===
def controllerName = &quot;Step 4 - Fetch Estimate by Title&quot;
def requestName = &quot;Get Project &amp; Details ID from Estimate Title&quot;

// === Step 1: Parse the JSON response ===
def response = prev.getResponseDataAsString()
def json = new JsonSlurper().parseText(response)

// === Step 2: Get Estimate Title from JMeter variable ===
def estimateTitleToFind = vars.get(&quot;ESTIMATE_TITLE&quot;)?.trim()
log.info(&quot;Looking for estimate title: &apos;${estimateTitleToFind}&apos;&quot;)
System.out.println(&quot;Looking for estimate title: &apos;${estimateTitleToFind}&apos;&quot;) // Console

// === Step 3: Search with Logging ===
def match = null
json.data.each { item -&gt;
    def title = item.projectTitle?.trim()
    log.info(&quot;Comparing with title: &apos;${title}&apos;&quot;)
    System.out.println(&quot;Comparing with title: &apos;${title}&apos;&quot;)
    if (title == estimateTitleToFind) {
        match = item
        log.info(&quot;✅ Match found!&quot;)
        System.out.println(&quot;✅ Match found!&quot;)
    }
}

if (match) {
    def projectId = match.projectId?.toString()
    def projectDetailsId = match.projectDetailsId?.toString()
    def projectCompositionLinkId = match.projectCompositionLinkId?.toString()
    def projectQuoteNo           = match.projectQuoteNo?.toString()
    def title                    = match.projectTitle?.toString()
    def parentId                 = match.parentId?.toString()
    def childEstimateCount       = match.childEstimateCount?.toString()

    // Save variables to JMeter
    vars.put(&quot;projectIds&quot;, projectId)
    vars.put(&quot;projectCompositionLinkId&quot;, projectCompositionLinkId)
    vars.put(&quot;projectQuoteNo&quot;, projectQuoteNo)
    vars.put(&quot;estimate_title&quot;, title)
    vars.put(&quot;parentId&quot;, parentId)
    vars.put(&quot;childEstimateCount&quot;, childEstimateCount)

    // === Structured Logging ===
    def header = &quot;================================================================&quot;
    def sep = &quot;----------------------------------------------------------------&quot;

    log.info(header)
    log.info(&quot;Controller   : ${controllerName}&quot;)
    log.info(&quot;Request Name : ${requestName}&quot;)
    log.info(header)
    log.info(&quot;Extracted Output&quot;)
    log.info(sep)
    log.info(&quot;ESTIMATE_TITLE         = ${estimateTitleToFind}&quot;)
    log.info(&quot;Project ID             = ${projectId}&quot;)
    log.info(&quot;Project Details ID     = ${projectDetailsId}&quot;)
    log.info(&quot;Project Composition ID = ${projectCompositionLinkId}&quot;)
    log.info(&quot;Project Quote No       = ${projectQuoteNo}&quot;)
    log.info(&quot;Parent ID              = ${parentId}&quot;)
    log.info(&quot;Child Estimate Count   = ${childEstimateCount}&quot;)
    log.info(header)

    System.out.println(header)
    System.out.println(&quot;Controller   : ${controllerName}&quot;)
    System.out.println(&quot;Request Name : ${requestName}&quot;)
    System.out.println(header)
    System.out.println(&quot;Extracted Output&quot;)
    System.out.println(sep)
    System.out.println(&quot;ESTIMATE_TITLE         = ${estimateTitleToFind}&quot;)
    System.out.println(&quot;Project ID             = ${projectId}&quot;)
    System.out.println(&quot;Project Details ID     = ${projectDetailsId}&quot;)
    System.out.println(&quot;Project Composition ID = ${projectCompositionLinkId}&quot;)
    System.out.println(&quot;Project Quote No       = ${projectQuoteNo}&quot;)
    System.out.println(&quot;Parent ID              = ${parentId}&quot;)
    System.out.println(&quot;Child Estimate Count   = ${childEstimateCount}&quot;)
    System.out.println(header)

} else {
    def errorMsg = &quot;❌ No matching project found for ESTIMATE_TITLE = &apos;${estimateTitleToFind}&apos;&quot;
    log.error(errorMsg)
    System.err.println(errorMsg)
    prev.setSuccessful(false) 
    prev.setResponseData(errorMsg, &quot;UTF-8&quot;)
}
</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
          </hashTree>
          <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Estimate Details Screen" enabled="true"/>
          <hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Get Estimate Details" enabled="true">
              <stringProp name="HTTPSampler.path">/api/v2/estimate/get/details</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">GET</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="estimateId" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">${projectIds}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                    <boolProp name="HTTPArgument.use_equals">true</boolProp>
                    <stringProp name="Argument.name">estimateId</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">//import groovy.json.JsonSlurper
//
//// === Parse response JSON ===
//def response = prev.getResponseDataAsString()
//def json = new JsonSlurper().parseText(response)
//
//// === Extract main project detail ===
//def projectDetail = json?.data?.projectDetail
//
//if (projectDetail) {
//    def projectDetailId    = projectDetail.id ?: &quot;null&quot;
//    def estimateId         = projectDetail.estimateId ?: &quot;null&quot;
//    def aggrDesc           = projectDetail.aggrDesc ?: &quot;null&quot;
//    def hashcode           = projectDetail.hashcode ?: &quot;null&quot;
//    def estimate           = projectDetail.estimate
//
//    // From nested estimate object
//    def estimateObjId      = estimate?.id ?: &quot;null&quot;
//    def tenantId           = estimate?.tenantId ?: &quot;null&quot;
//    def estimateNsetId     = estimate?.estimateNsetId ?: &quot;null&quot;
//    def estimateRequestId  = estimate?.estimateRequestId ?: &quot;null&quot;
//    def projectQuoteNo     = estimate?.projectQuoteNo ?: &quot;null&quot;
//    def projectTitle       = estimate?.projectTitle ?: &quot;null&quot;
//    def projectCost        = estimate?.projectCost ?: &quot;null&quot;
//    def regionId           = estimate?.regionId ?: &quot;null&quot;
//    def estimateTypeId     = estimate?.estimateTypeId ?: &quot;null&quot;
//    def scenarioId         = estimate?.scenarioId ?: &quot;null&quot;
//
//    // Save to JMeter variables
//    vars.put(&quot;projectDetailId&quot;, projectDetailId.toString())
//    vars.put(&quot;estimateId&quot;, estimateId.toString())
//    vars.put(&quot;aggrDesc&quot;, aggrDesc.toString())
//    vars.put(&quot;hashcode&quot;, hashcode.toString())
//
//    vars.put(&quot;estimateObjId&quot;, estimateObjId.toString())
//    vars.put(&quot;tenantId&quot;, tenantId.toString())
//    vars.put(&quot;estimateNsetId&quot;, estimateNsetId.toString())
//    vars.put(&quot;estimateRequestId&quot;, estimateRequestId.toString())
//    vars.put(&quot;projectQuoteNo&quot;, projectQuoteNo.toString())
//    vars.put(&quot;projectTitle&quot;, projectTitle.toString())
//    vars.put(&quot;projectCost&quot;, projectCost.toString())
//    vars.put(&quot;regionId&quot;, regionId.toString())
//    vars.put(&quot;estimateTypeId&quot;, estimateTypeId.toString())
//    vars.put(&quot;scenarioId&quot;, scenarioId.toString())
//}
//
//// === Extract all child projects ===
//def children = json?.data?.childProjectDetails
//def childCount = 0
//
//if (children &amp;&amp; children instanceof List) {
//    children.eachWithIndex { child, i -&gt;
//        def prefix = &quot;child_${i + 1}&quot; // Ex: child_1, child_2...
//
//        def estNsetId = child.estimateNsetId ?: &quot;null&quot;
//        def estId     = child.estimateId ?: &quot;null&quot;
//        def parentId  = child.parentId ?: &quot;null&quot;
//        def title     = child.projectTitle ?: &quot;null&quot;
//
//        vars.put(&quot;${prefix}_estimateNsetId&quot;, estNsetId.toString())
//        vars.put(&quot;${prefix}_estimateId&quot;, estId.toString())
//        vars.put(&quot;${prefix}_parentId&quot;, parentId.toString())
//        vars.put(&quot;${prefix}_projectTitle&quot;, title.toString())
//
//        childCount++
//    }
//    vars.put(&quot;child_count&quot;, childCount.toString())
//}
//
//// === Read index from user-defined variable and extract that child ===
//def childIndex = vars.get(&quot;childIndex&quot;)?.toInteger()
//if (childIndex &amp;&amp; childIndex &gt; 0 &amp;&amp; childIndex &lt;= childCount) {
//    def estNsetId = vars.get(&quot;child_${childIndex}_estimateNsetId&quot;)
//    def estId     = vars.get(&quot;child_${childIndex}_estimateId&quot;)
//    def parentId  = vars.get(&quot;child_${childIndex}_parentId&quot;)
//    def title     = vars.get(&quot;child_${childIndex}_projectTitle&quot;)
//
//    // Save selected child values into common variables for next request
//    vars.put(&quot;selected_estimateNsetId&quot;, estNsetId ?: &quot;&quot;)
//    vars.put(&quot;selected_estimateId&quot;, estId ?: &quot;&quot;)
//    vars.put(&quot;selected_parentId&quot;, parentId ?: &quot;&quot;)
//    vars.put(&quot;selected_projectTitle&quot;, title ?: &quot;&quot;)
//
//    log.info(&quot;✅ Extracted child_${childIndex} values for next request:&quot;)
//    log.info(&quot;  selected_estimateNsetId = ${estNsetId}&quot;)
//    log.info(&quot;  selected_estimateId     = ${estId}&quot;)
//    log.info(&quot;  selected_parentId       = ${parentId}&quot;)
//    log.info(&quot;  selected_projectTitle   = ${title}&quot;)
//} else {
//    log.warn(&quot;❌ Invalid or missing childIndex: ${childIndex} (max: ${childCount})&quot;)
//}
//
//log.info(&quot;==== Total children found: ${childCount} ====&quot;)


import groovy.json.JsonSlurper

// === Parse response JSON ===
def response = prev.getResponseDataAsString()
def json = new JsonSlurper().parseText(response)

// Helper function for dual logging
def dualLog = { msg -&gt;
    log.info(msg)                 // GUI mode
    System.out.println(msg)       // Non-GUI mode
}

dualLog(&quot;============================================================&quot;)
dualLog(&quot;📘 JSR223 PostProcessor - Project &amp; Child Extraction&quot;)
dualLog(&quot;------------------------------------------------------------&quot;)

// === Extract main project detail ===
def projectDetail = json?.data?.projectDetail

if (projectDetail) {
    def projectDetailId    = projectDetail.id ?: &quot;null&quot;
    def estimateId         = projectDetail.estimateId ?: &quot;null&quot;
    def aggrDesc           = projectDetail.aggrDesc ?: &quot;null&quot;
    def hashcode           = projectDetail.hashcode ?: &quot;null&quot;
    def estimate           = projectDetail.estimate

    // From nested estimate object
    def estimateObjId      = estimate?.id ?: &quot;null&quot;
    def tenantId           = estimate?.tenantId ?: &quot;null&quot;
    def estimateNsetId     = estimate?.estimateNsetId ?: &quot;null&quot;
    def estimateRequestId  = estimate?.estimateRequestId ?: &quot;null&quot;
    def projectQuoteNo     = estimate?.projectQuoteNo ?: &quot;null&quot;
    def projectTitle       = estimate?.projectTitle ?: &quot;null&quot;
    def projectCost        = estimate?.projectCost ?: &quot;null&quot;
    def regionId           = estimate?.regionId ?: &quot;null&quot;
    def estimateTypeId     = estimate?.estimateTypeId ?: &quot;null&quot;
    def scenarioId         = estimate?.scenarioId ?: &quot;null&quot;

    // Save to JMeter variables
    vars.put(&quot;projectDetailId&quot;, projectDetailId.toString())
    vars.put(&quot;estimateId&quot;, estimateId.toString())
    vars.put(&quot;aggrDesc&quot;, aggrDesc.toString())
    vars.put(&quot;hashcode&quot;, hashcode.toString())

    vars.put(&quot;estimateObjId&quot;, estimateObjId.toString())
    vars.put(&quot;tenantId&quot;, tenantId.toString())
    vars.put(&quot;estimateNsetId&quot;, estimateNsetId.toString())
    vars.put(&quot;estimateRequestId&quot;, estimateRequestId.toString())
    vars.put(&quot;projectQuoteNo&quot;, projectQuoteNo.toString())
    vars.put(&quot;projectTitle&quot;, projectTitle.toString())
    vars.put(&quot;projectCost&quot;, projectCost.toString())
    vars.put(&quot;regionId&quot;, regionId.toString())
    vars.put(&quot;estimateTypeId&quot;, estimateTypeId.toString())
    vars.put(&quot;scenarioId&quot;, scenarioId.toString())

    // Log extracted main project details
    dualLog(&quot;📂 Main Project:&quot;)
    dualLog(&quot;   projectDetailId : ${projectDetailId}&quot;)
    dualLog(&quot;   estimateId      : ${estimateId}&quot;)
    dualLog(&quot;   aggrDesc        : ${aggrDesc}&quot;)
    dualLog(&quot;   hashcode        : ${hashcode}&quot;)
    dualLog(&quot;   projectQuoteNo  : ${projectQuoteNo}&quot;)
    dualLog(&quot;   projectTitle    : ${projectTitle}&quot;)
    dualLog(&quot;   projectCost     : ${projectCost}&quot;)
}

// === Extract all child projects ===
def children = json?.data?.childProjectDetails
def childCount = 0

if (children &amp;&amp; children instanceof List) {
    dualLog(&quot;📂 Child Projects Found: ${children.size()}&quot;)

    children.eachWithIndex { child, i -&gt;
        def prefix = &quot;child_${i + 1}&quot; // Ex: child_1, child_2...

        def estNsetId = child.estimateNsetId ?: &quot;null&quot;
        def estId     = child.estimateId ?: &quot;null&quot;
        def parentId  = child.parentId ?: &quot;null&quot;
        def title     = child.projectTitle ?: &quot;null&quot;

        vars.put(&quot;${prefix}_estimateNsetId&quot;, estNsetId.toString())
        vars.put(&quot;${prefix}_estimateId&quot;, estId.toString())
        vars.put(&quot;${prefix}_parentId&quot;, parentId.toString())
        vars.put(&quot;${prefix}_projectTitle&quot;, title.toString())

        dualLog(&quot;   ➡ ${prefix}:&quot;)
        dualLog(&quot;      estimateNsetId : ${estNsetId}&quot;)
        dualLog(&quot;      estimateId     : ${estId}&quot;)
        dualLog(&quot;      parentId       : ${parentId}&quot;)
        dualLog(&quot;      projectTitle   : ${title}&quot;)

        childCount++
    }
    vars.put(&quot;child_count&quot;, childCount.toString())
} else {
    dualLog(&quot;⚠️ No child projects found.&quot;)
}

// === Read index from user-defined variable and extract that child ===
def childIndex = vars.get(&quot;childIndex&quot;)?.toInteger()
if (childIndex &amp;&amp; childIndex &gt; 0 &amp;&amp; childIndex &lt;= childCount) {
    def estNsetId = vars.get(&quot;child_${childIndex}_estimateNsetId&quot;)
    def estId     = vars.get(&quot;child_${childIndex}_estimateId&quot;)
    def parentId  = vars.get(&quot;child_${childIndex}_parentId&quot;)
    def title     = vars.get(&quot;child_${childIndex}_projectTitle&quot;)

    // Save selected child values into common variables for next request
    vars.put(&quot;selected_estimateNsetId&quot;, estNsetId ?: &quot;&quot;)
    vars.put(&quot;selected_estimateId&quot;, estId ?: &quot;&quot;)
    vars.put(&quot;selected_parentId&quot;, parentId ?: &quot;&quot;)
    vars.put(&quot;selected_projectTitle&quot;, title ?: &quot;&quot;)

    dualLog(&quot;✅ Extracted child_${childIndex} values for next request:&quot;)
    dualLog(&quot;   selected_estimateNsetId = ${estNsetId}&quot;)
    dualLog(&quot;   selected_estimateId     = ${estId}&quot;)
    dualLog(&quot;   selected_parentId       = ${parentId}&quot;)
    dualLog(&quot;   selected_projectTitle   = ${title}&quot;)
} else {
    dualLog(&quot;❌ Invalid or missing childIndex: ${childIndex} (max: ${childCount})&quot;)
}

dualLog(&quot;============================================================&quot;)
dualLog(&quot;==== Total children found: ${childCount} ====&quot;)
dualLog(&quot;============================================================&quot;)

</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Estimate View" enabled="true">
              <stringProp name="HTTPSampler.path">/api/v2/estimate/estimate-view</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
    &quot;projectId&quot;: ${__V(child_${childIndex}_estimateNsetId)},&#xd;
    &quot;offset&quot;: 1,&#xd;
    &quot;recordsPerPage&quot;: 250,&#xd;
    &quot;direction&quot;: &quot;forward&quot;,&#xd;
    &quot;aggregateLevel&quot;: &quot;section&quot;,&#xd;
    &quot;expandedList&quot;: []&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree/>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Get Estimate Data List" enabled="true">
              <stringProp name="HTTPSampler.path">/api/v2/estimate/get-estimatedata-list</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="projectId" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">${__V(child_${childIndex}_estimateNsetId)}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                    <boolProp name="HTTPArgument.use_equals">true</boolProp>
                    <stringProp name="Argument.name">projectId</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree/>
          </hashTree>
          <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Create Section" enabled="true"/>
          <hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Estimate view" enabled="true">
              <stringProp name="HTTPSampler.path">/api/v2/estimate/estimate-view</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&quot;projectId&quot;:${__V(child_${childIndex}_estimateId)},&quot;offset&quot;:1,&quot;recordsPerPage&quot;:1000,&quot;direction&quot;:&quot;forward&quot;,&quot;aggregateLevel&quot;:&quot;section&quot;,&quot;expandedList&quot;:[]}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree/>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Expand estimate-view" enabled="true">
              <stringProp name="HTTPSampler.path">/api/v2/estimate/estimate-view</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&quot;projectId&quot;:${__V(child_${childIndex}_estimateId)},&quot;offset&quot;:${projectLeftValue},&quot;recordsPerPage&quot;:1,&quot;direction&quot;:&quot;forward&quot;,&quot;aggregateLevel&quot;:&quot;section&quot;,&quot;expandedList&quot;:[${projectCarbonEstimateNsetId}]}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree/>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Section: Section number already exists">
              <stringProp name="HTTPSampler.path">/api/v2/estimate/create</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
    &quot;recordType&quot;: 1,&#xd;
    &quot;parentId&quot;: 163668,&#xd;
    &quot;aggrDesc&quot;: &quot;qq&quot;,&#xd;
    &quot;CarbonData&quot;: {},&#xd;
    &quot;ProjectSectionId&quot;: 1,&#xd;
    &quot;estimateId&quot;: 6270,&#xd;
    &quot;projectDetail&quot;: {},&#xd;
    &quot;projectSection&quot;: {&#xd;
        &quot;projectSectionNumber&quot;: &quot;qq&quot;,&#xd;
        &quot;projectSectionDesc&quot;: &quot;qq&quot;,&#xd;
        &quot;projectSectionProdRate&quot;: 4,&#xd;
        &quot;unitId&quot;: 22&#xd;
    },&#xd;
    &quot;hasValidationError&quot;: false&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages" enabled="true">
                <stringProp name="JSONPostProcessor.referenceNames">respMessage;respErrMsg;respErrClass</stringProp>
                <stringProp name="JSONPostProcessor.jsonPathExprs">$.message;$.errors.Message;$.errors.ClassName</stringProp>
                <stringProp name="JSONPostProcessor.match_numbers">0;0;0</stringProp>
                <stringProp name="Sample.scope">all</stringProp>
                <stringProp name="Scope.variable"> </stringProp>
                <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
              </JSONPostProcessor>
              <hashTree/>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">// Extracted vars
def message   = vars.get(&quot;respMessage&quot;) ?: &quot;NOT_FOUND&quot;
def errMsg    = vars.get(&quot;respErrMsg&quot;) ?: &quot;NOT_FOUND&quot;
def errClass  = vars.get(&quot;respErrClass&quot;) ?: &quot;NOT_FOUND&quot;
def respCode  = prev.getResponseCode() ?: &quot;NO_CODE&quot;

// Log to JMeter GUI
log.info(&quot;===================================================&quot;)
log.info(&quot;📘 API Error Extracted - Project Section&quot;)
log.info(&quot;HTTP Status Code   : &quot; + respCode)
log.info(&quot;Message            : &quot; + message)
log.info(&quot;Error Class        : &quot; + errClass)
log.info(&quot;Error Detail       : &quot; + errMsg)
log.info(&quot;===================================================&quot;)

// Print to Console (non-GUI)
println(&quot;===================================================&quot;)
println(&quot;📘 API Error Extracted - Project Section&quot;)
println(&quot;HTTP Status Code   : &quot; + respCode)
println(&quot;Message            : &quot; + message)
println(&quot;Error Class        : &quot; + errClass)
println(&quot;Error Detail       : &quot; + errMsg)
println(&quot;===================================================&quot;)
</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Section: unitId field is required">
              <stringProp name="HTTPSampler.domain">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </stringProp>
              <stringProp name="HTTPSampler.path">/api/v2/estimate/create</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
    &quot;recordType&quot;: 1,&#xd;
    &quot;parentId&quot;: 163668,&#xd;
    &quot;aggrDesc&quot;: &quot;qq&quot;,&#xd;
    &quot;CarbonData&quot;: {},&#xd;
    &quot;ProjectSectionId&quot;: 1,&#xd;
    &quot;estimateId&quot;: 6270,&#xd;
    &quot;projectDetail&quot;: {},&#xd;
    &quot;projectSection&quot;: {&#xd;
        &quot;projectSectionNumber&quot;: &quot;qq&quot;,&#xd;
        &quot;projectSectionDesc&quot;: &quot;qq&quot;,&#xd;
        &quot;projectSectionProdRate&quot;: 4,&#xd;
        &quot;unitId&quot;: &#xd;
    },&#xd;
    &quot;hasValidationError&quot;: false&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages" enabled="true">
                <stringProp name="JSONPostProcessor.referenceNames">respTitle;respStatus;respErrProj;respErrDetail;respErrUnit</stringProp>
                <stringProp name="JSONPostProcessor.jsonPathExprs">$.title;$.status;$.errors.projectSection[0];$.errors.projectDetailDTO[0];$.errors[&apos;projectSection.unitId&apos;][0]</stringProp>
                <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0;0</stringProp>
                <stringProp name="Sample.scope">all</stringProp>
                <stringProp name="Scope.variable"> </stringProp>
                <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
              </JSONPostProcessor>
              <hashTree/>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">// Extracted variables
def title       = vars.get(&quot;respTitle&quot;) ?: &quot;NOT_FOUND&quot;
def statusCode  = vars.get(&quot;respStatus&quot;) ?: &quot;NOT_FOUND&quot;
def errProj     = vars.get(&quot;respErrProj&quot;) ?: &quot;NOT_FOUND&quot;
def errDetail   = vars.get(&quot;respErrDetail&quot;) ?: &quot;NOT_FOUND&quot;
def errUnit     = vars.get(&quot;respErrUnit&quot;) ?: &quot;NOT_FOUND&quot;
def respCode    = prev.getResponseCode() ?: &quot;NO_CODE&quot;

// Log to JMeter GUI
log.info(&quot;===================================================&quot;)
log.info(&quot;📘 API Validation Error Extracted&quot;)
log.info(&quot;HTTP Status Code   : &quot; + respCode)
log.info(&quot;Title              : &quot; + title)
log.info(&quot;Status Field       : &quot; + statusCode)
log.info(&quot;ProjectSection Err : &quot; + errProj)
log.info(&quot;DetailDTO Err      : &quot; + errDetail)
log.info(&quot;UnitId Err         : &quot; + errUnit)
log.info(&quot;===================================================&quot;)

// Print to Console (non-GUI mode)
println(&quot;===================================================&quot;)
println(&quot;📘 API Validation Error Extracted&quot;)
println(&quot;HTTP Status Code   : &quot; + respCode)
println(&quot;Title              : &quot; + title)
println(&quot;Status Field       : &quot; + statusCode)
println(&quot;ProjectSection Err : &quot; + errProj)
println(&quot;DetailDTO Err      : &quot; + errDetail)
println(&quot;UnitId Err         : &quot; + errUnit)
println(&quot;===================================================&quot;)
</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Section: parentId field is required">
              <stringProp name="HTTPSampler.path">/api/v2/estimate/create</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
    &quot;recordType&quot;: 1,&#xd;
    &quot;parentId&quot;: ,&#xd;
    &quot;aggrDesc&quot;: &quot;qq&quot;,&#xd;
    &quot;CarbonData&quot;: {},&#xd;
    &quot;ProjectSectionId&quot;: 1,&#xd;
    &quot;estimateId&quot;: 6270,&#xd;
    &quot;projectDetail&quot;: {},&#xd;
    &quot;projectSection&quot;: {&#xd;
        &quot;projectSectionNumber&quot;: &quot;qq&quot;,&#xd;
        &quot;projectSectionDesc&quot;: &quot;qq&quot;,&#xd;
        &quot;projectSectionProdRate&quot;: 4,&#xd;
        &quot;unitId&quot;: 22&#xd;
    },&#xd;
    &quot;hasValidationError&quot;: false&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages" enabled="true">
                <stringProp name="JSONPostProcessor.referenceNames">respTitle;respStatus;respErrParent;respErrDetail</stringProp>
                <stringProp name="JSONPostProcessor.jsonPathExprs">$.title;$.status;$.errors.parentId[0];$.errors.projectDetailDTO[0]</stringProp>
                <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0</stringProp>
                <stringProp name="Sample.scope">all</stringProp>
                <stringProp name="Scope.variable"> </stringProp>
                <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
              </JSONPostProcessor>
              <hashTree/>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">// Extracted variables
def title       = vars.get(&quot;respTitle&quot;) ?: &quot;NOT_FOUND&quot;
def statusCode  = vars.get(&quot;respStatus&quot;) ?: &quot;NOT_FOUND&quot;
def errParent   = vars.get(&quot;respErrParent&quot;) ?: &quot;NOT_FOUND&quot;
def errDetail   = vars.get(&quot;respErrDetail&quot;) ?: &quot;NOT_FOUND&quot;
def respCode    = prev.getResponseCode() ?: &quot;NO_CODE&quot;

// Log to JMeter GUI
log.info(&quot;===================================================&quot;)
log.info(&quot;📘 API Validation Error Extracted&quot;)
log.info(&quot;HTTP Status Code   : &quot; + respCode)
log.info(&quot;Title              : &quot; + title)
log.info(&quot;Status Field       : &quot; + statusCode)
log.info(&quot;ParentId Err       : &quot; + errParent)
log.info(&quot;DetailDTO Err      : &quot; + errDetail)
log.info(&quot;===================================================&quot;)

// Print to Console (non-GUI mode)
println(&quot;===================================================&quot;)
println(&quot;📘 API Validation Error Extracted&quot;)
println(&quot;HTTP Status Code   : &quot; + respCode)
println(&quot;Title              : &quot; + title)
println(&quot;Status Field       : &quot; + statusCode)
println(&quot;ParentId Err       : &quot; + errParent)
println(&quot;DetailDTO Err      : &quot; + errDetail)
println(&quot;===================================================&quot;)
</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Section: estimateId field is required">
              <stringProp name="HTTPSampler.path">/api/v2/estimate/create</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
    &quot;recordType&quot;: 1,&#xd;
    &quot;parentId&quot;: 163668,&#xd;
    &quot;aggrDesc&quot;: &quot;qq&quot;,&#xd;
    &quot;CarbonData&quot;: {},&#xd;
    &quot;ProjectSectionId&quot;: 1,&#xd;
    &quot;estimateId&quot;: ,&#xd;
    &quot;projectDetail&quot;: {},&#xd;
    &quot;projectSection&quot;: {&#xd;
        &quot;projectSectionNumber&quot;: &quot;qq&quot;,&#xd;
        &quot;projectSectionDesc&quot;: &quot;qq&quot;,&#xd;
        &quot;projectSectionProdRate&quot;: 4,&#xd;
        &quot;unitId&quot;: 22&#xd;
    },&#xd;
    &quot;hasValidationError&quot;: false&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages" enabled="true">
                <stringProp name="JSONPostProcessor.referenceNames">respTitle;respStatus;respErrEstimateId;respErrDetailDTO</stringProp>
                <stringProp name="JSONPostProcessor.jsonPathExprs">$.title;$.status;$.errors.estimateId[0];$.errors.projectDetailDTO[0]</stringProp>
                <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0</stringProp>
                <stringProp name="Sample.scope">all</stringProp>
                <stringProp name="Scope.variable"> </stringProp>
                <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
              </JSONPostProcessor>
              <hashTree/>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">// Extracted variables
def title       = vars.get(&quot;respTitle&quot;) ?: &quot;NOT_FOUND&quot;
def statusCode  = vars.get(&quot;respStatus&quot;) ?: &quot;NOT_FOUND&quot;
def errEstimate = vars.get(&quot;respErrEstimateId&quot;) ?: &quot;NOT_FOUND&quot;
def errDetail   = vars.get(&quot;respErrDetailDTO&quot;) ?: &quot;NOT_FOUND&quot;
def respCode    = prev.getResponseCode() ?: &quot;NO_CODE&quot;

// Log to JMeter GUI (View Results Tree / jmeter.log)
log.info(&quot;===================================================&quot;)
log.info(&quot;📘 API Validation Error Extracted&quot;)
log.info(&quot;HTTP Status Code   : &quot; + respCode)
log.info(&quot;Title              : &quot; + title)
log.info(&quot;Status Field       : &quot; + statusCode)
log.info(&quot;EstimateId Err     : &quot; + errEstimate)
log.info(&quot;DetailDTO Err      : &quot; + errDetail)
log.info(&quot;===================================================&quot;)

// Print to Console (Non-GUI mode)
println(&quot;===================================================&quot;)
println(&quot;📘 API Validation Error Extracted&quot;)
println(&quot;HTTP Status Code   : &quot; + respCode)
println(&quot;Title              : &quot; + title)
println(&quot;Status Field       : &quot; + statusCode)
println(&quot;EstimateId Err     : &quot; + errEstimate)
println(&quot;DetailDTO Err      : &quot; + errDetail)
println(&quot;===================================================&quot;)
</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Section: ProjectSection is mandatory">
              <stringProp name="HTTPSampler.path">/api/v2/estimate/create</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
    &quot;recordType&quot;: 1,&#xd;
    &quot;parentId&quot;: 163668,&#xd;
    &quot;aggrDesc&quot;: &quot;qhq&quot;,&#xd;
    &quot;CarbonData&quot;: {},&#xd;
    &quot;ProjectSectionId&quot;: 1,&#xd;
    &quot;estimateId&quot;: 6270,&#xd;
    &quot;projectDetail&quot;: {},&#xd;
   &#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages">
                <stringProp name="JSONPostProcessor.referenceNames">respErrors;respTitle;respStatus;respTraceId</stringProp>
                <stringProp name="JSONPostProcessor.jsonPathExprs">$.errors.ProjectSection[0];$.title;$.status;$.traceId</stringProp>
                <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0</stringProp>
                <stringProp name="Sample.scope">all</stringProp>
                <stringProp name="Scope.variable"> </stringProp>
                <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
              </JSONPostProcessor>
              <hashTree/>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">// Extracted variables
def errorMsg   = vars.get(&quot;respErrors&quot;) ?: &quot;NOT_FOUND&quot;
def title      = vars.get(&quot;respTitle&quot;) ?: &quot;NOT_FOUND&quot;
def statusCode = vars.get(&quot;respStatus&quot;) ?: &quot;NOT_FOUND&quot;
def traceId    = vars.get(&quot;respTraceId&quot;) ?: &quot;NOT_FOUND&quot;

// Log to JMeter GUI (jmeter.log / View Results Tree)
log.info(&quot;===================================================&quot;)
log.info(&quot;📘 Extracted API Error Details&quot;)
log.info(&quot;Error Message : &quot; + errorMsg)
log.info(&quot;Title         : &quot; + title)
log.info(&quot;Status Code   : &quot; + statusCode)
log.info(&quot;TraceId       : &quot; + traceId)
log.info(&quot;===================================================&quot;)

// Print to Console (non-GUI mode)
println(&quot;===================================================&quot;)
println(&quot;📘 Extracted API Error Details&quot;)
println(&quot;Error Message : &quot; + errorMsg)
println(&quot;Title         : &quot; + title)
println(&quot;Status Code   : &quot; + statusCode)
println(&quot;TraceId       : &quot; + traceId)
println(&quot;===================================================&quot;)
</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
          </hashTree>
          <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Auto allocate - O&amp;M Area 9 Unit Rate Item Library - O&amp;M Area 9 Unit Rate Item Library" enabled="true"/>
          <hashTree>
            <LoopController guiclass="LoopControlPanel" testclass="LoopController" testname="Auto Allocate" enabled="true">
              <stringProp name="LoopController.loops">${ITEM_LIBRARY_COUNT}</stringProp>
            </LoopController>
            <hashTree>
              <CSVDataSet guiclass="TestBeanGUI" testclass="CSVDataSet" testname="CSV Data Set Config" enabled="true">
                <stringProp name="filename">C:\Users\radhakrishnanv\Working Project\Benchmark_Estimating\Integration Environment\CSV data files\Negative_Auto_Allocate_TestData.csv</stringProp>
                <stringProp name="fileEncoding">UTF-8</stringProp>
                <stringProp name="variableNames"></stringProp>
                <boolProp name="ignoreFirstLine">false</boolProp>
                <stringProp name="delimiter">,</stringProp>
                <boolProp name="quotedData">false</boolProp>
                <boolProp name="recycle">true</boolProp>
                <boolProp name="stopThread">false</boolProp>
                <stringProp name="shareMode">shareMode.all</stringProp>
              </CSVDataSet>
              <hashTree/>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Normal Item: The projectDetailDTO field &quot;parentId&quot; is required">
                <stringProp name="HTTPSampler.path">/api/v2/estimate/create</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">POST</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
    &quot;parentId&quot;: ,&#xd;
    &quot;recordType&quot;: 3,&#xd;
    &quot;CarbonData&quot;: {},&#xd;
    &quot;estimateNsetId&quot;: 0,&#xd;
    &quot;estimateId&quot;: 6270,&#xd;
    &quot;projectDetail&quot;: {},&#xd;
    &quot;aggrCode&quot;: &quot;Rkitem23&quot;,&#xd;
    &quot;activityId&quot;: &quot;&quot;,&#xd;
    &quot;projectItem&quot;: {&#xd;
        &quot;projectItemQty&quot;: 3,&#xd;
        &quot;unitId&quot;: 22,&#xd;
        &quot;itemGroupId&quot;: 0,&#xd;
        &quot;costCodeId&quot;: 0,&#xd;
        &quot;activityId&quot;: 0,&#xd;
        &quot;projectItemKey&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCartDis&quot;: 0,&#xd;
        &quot;projectItemWbsLevel&quot;: null,&#xd;
        &quot;projectItemStartDate&quot;: null,&#xd;
        &quot;depotId&quot;: null,&#xd;
        &quot;projectItemText&quot;: &quot;&quot;,&#xd;
        &quot;projectItemProdRate&quot;: 1.17,&#xd;
        &quot;projectItemDuration&quot;: null,&#xd;
        &quot;projectItemRateOnlyAmount&quot;: null,              &#xd;
        &quot;projectItemProvSumAmount&quot;: null,&#xd;
        &quot;projectItemNonCalculation&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemRateOnly&quot;: &quot;&quot;,&#xd;
        &quot;projectItemIsProvSum&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCalculation&quot;: &quot;3&quot;,&#xd;
        &quot;projectDetail&quot;: {},&#xd;
        &quot;projectItemParentId&quot;: 367667,&#xd;
        &quot;projectItemId&quot;: 1,&#xd;
        &quot;isSubItem&quot;: &quot;n&quot;,&#xd;
        &quot;projectItemAllocateCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcML&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCbs&quot;: &quot;test&quot;,&#xd;
        &quot;unitDescription&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode2&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode3&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode4&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemNotes&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcMax&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCalcMin&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemChanged&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCostOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemInfoProv&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemStemCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemTextOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsClaimed&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsForecast&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsOverhead&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemSpreadType&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemTosFormula&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemDoNotSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCurrencyCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemPricingMethod&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSynchronised&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCompositeType&quot;: 3&#xd;
    },&#xd;
    &quot;aggrDesc&quot;: &quot;Rkitem23&quot;&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages" enabled="true">
                  <stringProp name="JSONPostProcessor.referenceNames">err_title;err_status;err_traceid;err_msgs</stringProp>
                  <stringProp name="JSONPostProcessor.jsonPathExprs">$.title;$.status;$.traceId;$.errors.*[*]</stringProp>
                  <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0</stringProp>
                  <stringProp name="Sample.scope">all</stringProp>
                  <stringProp name="Scope.variable"> </stringProp>
                  <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
                </JSONPostProcessor>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">// Get extracted variables
def title = vars.get(&quot;err_title&quot;) ?: &quot;TITLE_NOT_FOUND&quot;
def status = vars.get(&quot;err_status&quot;) ?: &quot;STATUS_NOT_FOUND&quot;
def traceId = vars.get(&quot;err_traceid&quot;) ?: &quot;TRACEID_NOT_FOUND&quot;

// Collect all error messages
def errors = []
def count = vars.get(&quot;err_msgs_matchNr&quot;) as Integer ?: 0
(1..count).each { i -&gt;
    def msg = vars.get(&quot;err_msgs_&quot; + i)
    if (msg) errors &lt;&lt; msg
}

// Structured Logging
log.info(&quot;====================================================&quot;)
log.info(&quot;🔎 Validation Error Response&quot;)
log.info(&quot;Title   : ${title}&quot;)
log.info(&quot;Status  : ${status}&quot;)
log.info(&quot;TraceId : ${traceId}&quot;)
log.info(&quot;Errors  : ${errors.join(&apos; | &apos;)}&quot;)
log.info(&quot;====================================================&quot;)

// Print to Console (non-GUI mode)
println(&quot;====================================================&quot;)
println(&quot;🔎 Validation Error Response&quot;)
println(&quot;Title   : ${title}&quot;)
println(&quot;Status  : ${status}&quot;)
println(&quot;TraceId : ${traceId}&quot;)
println(&quot;Errors  : ${errors.join(&apos; | &apos;)}&quot;)
println(&quot;====================================================&quot;)
</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Normal Item: The projectDetailDTO field &quot;estimateId&quot; is required">
                <stringProp name="HTTPSampler.path">/api/v2/estimate/create</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">POST</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
    &quot;parentId&quot;: 367667,&#xd;
    &quot;recordType&quot;: 3,&#xd;
    &quot;CarbonData&quot;: {},&#xd;
    &quot;estimateNsetId&quot;: 0,&#xd;
    &quot;estimateId&quot;: ,&#xd;
    &quot;projectDetail&quot;: {},&#xd;
    &quot;aggrCode&quot;: &quot;Rkitem23&quot;,&#xd;
    &quot;activityId&quot;: &quot;&quot;,&#xd;
    &quot;projectItem&quot;: {&#xd;
        &quot;projectItemQty&quot;: 3,&#xd;
        &quot;unitId&quot;: 22,&#xd;
        &quot;itemGroupId&quot;: 0,&#xd;
        &quot;costCodeId&quot;: 0,&#xd;
        &quot;activityId&quot;: 0,&#xd;
        &quot;projectItemKey&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCartDis&quot;: 0,&#xd;
        &quot;projectItemWbsLevel&quot;: null,&#xd;
        &quot;projectItemStartDate&quot;: null,&#xd;
        &quot;depotId&quot;: null,&#xd;
        &quot;projectItemText&quot;: &quot;&quot;,&#xd;
        &quot;projectItemProdRate&quot;: 1.17,&#xd;
        &quot;projectItemDuration&quot;: null,&#xd;
        &quot;projectItemRateOnlyAmount&quot;: null,&#xd;
        &quot;projectItemProvSumAmount&quot;: null,&#xd;
        &quot;projectItemNonCalculation&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemRateOnly&quot;: &quot;&quot;,&#xd;
        &quot;projectItemIsProvSum&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCalculation&quot;: &quot;3&quot;,&#xd;
        &quot;projectDetail&quot;: {},&#xd;
        &quot;projectItemParentId&quot;: 367667,&#xd;
        &quot;projectItemId&quot;: 1,&#xd;
        &quot;isSubItem&quot;: &quot;n&quot;,&#xd;
        &quot;projectItemAllocateCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcML&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCbs&quot;: &quot;test&quot;,&#xd;
        &quot;unitDescription&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode2&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode3&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode4&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemNotes&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcMax&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCalcMin&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemChanged&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCostOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemInfoProv&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemStemCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemTextOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsClaimed&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsForecast&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsOverhead&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemSpreadType&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemTosFormula&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemDoNotSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCurrencyCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemPricingMethod&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSynchronised&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCompositeType&quot;: 3&#xd;
    },&#xd;
    &quot;aggrDesc&quot;: &quot;Rkitem23&quot;&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages" enabled="true">
                  <stringProp name="JSONPostProcessor.referenceNames">err_estimateId;err_projectDetailDTO;resp_title;resp_status;resp_traceId</stringProp>
                  <stringProp name="JSONPostProcessor.jsonPathExprs">$.errors.estimateId[0];$.errors.projectDetailDTO[0];$.title;$.status;$.traceId</stringProp>
                  <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0;0</stringProp>
                  <stringProp name="Sample.scope">all</stringProp>
                  <stringProp name="Scope.variable"> </stringProp>
                  <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
                </JSONPostProcessor>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">// Get extracted values
def estimateIdErr = vars.get(&quot;err_estimateId&quot;) ?: &quot;NOT_FOUND&quot;
def projDetailErr = vars.get(&quot;err_projectDetailDTO&quot;) ?: &quot;NOT_FOUND&quot;
def title = vars.get(&quot;resp_title&quot;) ?: &quot;NOT_FOUND&quot;
def status = vars.get(&quot;resp_status&quot;) ?: &quot;NOT_FOUND&quot;
def traceId = vars.get(&quot;resp_traceId&quot;) ?: &quot;NOT_FOUND&quot;

// Print structured logs
log.info(&quot;===================================================&quot;)
log.info(&quot;📌 Validation Error Response&quot;)
log.info(&quot;EstimateId Error : &quot; + estimateIdErr)
log.info(&quot;ProjectDetailDTO Error : &quot; + projDetailErr)
log.info(&quot;Title : &quot; + title)
log.info(&quot;Status Code : &quot; + status)
log.info(&quot;TraceId : &quot; + traceId)
log.info(&quot;===================================================&quot;)

// Also print to Console (Non-GUI mode)
println(&quot;===================================================&quot;)
println(&quot;📌 Validation Error Response&quot;)
println(&quot;EstimateId Error : &quot; + estimateIdErr)
println(&quot;ProjectDetailDTO Error : &quot; + projDetailErr)
println(&quot;Title : &quot; + title)
println(&quot;Status Code : &quot; + status)
println(&quot;TraceId : &quot; + traceId)
println(&quot;===================================================&quot;)
</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Normal Item: The projectDetailDTO field &quot;projectItemQty&quot; is required">
                <stringProp name="HTTPSampler.path">/api/v2/estimate/create</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">POST</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
    &quot;parentId&quot;: 367667,&#xd;
    &quot;recordType&quot;: 3,&#xd;
    &quot;CarbonData&quot;: {},&#xd;
    &quot;estimateNsetId&quot;: 0,&#xd;
    &quot;estimateId&quot;: 6270,&#xd;
    &quot;projectDetail&quot;: {},&#xd;
    &quot;aggrCode&quot;: &quot;Rkitem23&quot;,&#xd;
    &quot;activityId&quot;: &quot;&quot;,&#xd;
    &quot;projectItem&quot;: {&#xd;
        &quot;projectItemQty&quot;: ,&#xd;
        &quot;unitId&quot;: 22,&#xd;
        &quot;itemGroupId&quot;: 0,&#xd;
        &quot;costCodeId&quot;: 0,&#xd;
        &quot;activityId&quot;: 0,&#xd;
        &quot;projectItemKey&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCartDis&quot;: 0,&#xd;
        &quot;projectItemWbsLevel&quot;: null,&#xd;
        &quot;projectItemStartDate&quot;: null,&#xd;
        &quot;depotId&quot;: null,&#xd;
        &quot;projectItemText&quot;: &quot;&quot;,&#xd;
        &quot;projectItemProdRate&quot;: 1.17,&#xd;
        &quot;projectItemDuration&quot;: null,&#xd;
        &quot;projectItemRateOnlyAmount&quot;: null,&#xd;
        &quot;projectItemProvSumAmount&quot;: null,&#xd;
        &quot;projectItemNonCalculation&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemRateOnly&quot;: &quot;&quot;,&#xd;
        &quot;projectItemIsProvSum&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCalculation&quot;: &quot;3&quot;,&#xd;
        &quot;projectDetail&quot;: {},&#xd;
        &quot;projectItemParentId&quot;: 367667,&#xd;
        &quot;projectItemId&quot;: 1,&#xd;
        &quot;isSubItem&quot;: &quot;n&quot;,&#xd;
        &quot;projectItemAllocateCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcML&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCbs&quot;: &quot;test&quot;,&#xd;
        &quot;unitDescription&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode2&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode3&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode4&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemNotes&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcMax&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCalcMin&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemChanged&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCostOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemInfoProv&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemStemCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemTextOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsClaimed&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsForecast&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsOverhead&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemSpreadType&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemTosFormula&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemDoNotSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCurrencyCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemPricingMethod&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSynchronised&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCompositeType&quot;: 3&#xd;
    },&#xd;
    &quot;aggrDesc&quot;: &quot;Rkitem23&quot;&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages" enabled="true">
                  <stringProp name="JSONPostProcessor.referenceNames">estimateId;errors;title;status;traceId</stringProp>
                  <stringProp name="JSONPostProcessor.jsonPathExprs">$.estimateId;$.errors;$.title;$.status;$.traceId</stringProp>
                  <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0;0</stringProp>
                  <stringProp name="Sample.scope">all</stringProp>
                  <stringProp name="Scope.variable"> </stringProp>
                  <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
                </JSONPostProcessor>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">// Get extracted variables
def estimateId = vars.get(&quot;estimateId&quot;) ?: &quot;NOT_FOUND&quot;
def errors     = vars.get(&quot;errors&quot;) ?: &quot;NOT_FOUND&quot;
def title      = vars.get(&quot;title&quot;) ?: &quot;NOT_FOUND&quot;
def status     = vars.get(&quot;status&quot;) ?: &quot;NOT_FOUND&quot;
def traceId    = vars.get(&quot;traceId&quot;) ?: &quot;NOT_FOUND&quot;

// Structured logging
def logMessage = &quot;&quot;&quot;
==================== Validation Response ====================
 Title      : ${title}
 Status     : ${status}
 TraceId    : ${traceId}
 Errors     : ${errors}
=============================================================
&quot;&quot;&quot;

// Log to JMeter GUI
log.info(logMessage)

// Log to console (non-GUI mode)
System.out.println(logMessage)
</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Normal Item: The projectDetailDTO field &quot;projectItem.unitId&quot; is required">
                <stringProp name="HTTPSampler.path">/api/v2/estimate/create</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">POST</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
    &quot;parentId&quot;: 367667,&#xd;
    &quot;recordType&quot;: 3,&#xd;
    &quot;CarbonData&quot;: {},&#xd;
    &quot;estimateNsetId&quot;: 0,&#xd;
    &quot;estimateId&quot;: 6270,&#xd;
    &quot;projectDetail&quot;: {},&#xd;
    &quot;aggrCode&quot;: &quot;Rkitem23&quot;,&#xd;
    &quot;activityId&quot;: &quot;&quot;,&#xd;
    &quot;projectItem&quot;: {&#xd;
        &quot;projectItemQty&quot;: 3,&#xd;
        &quot;unitId&quot;: ,&#xd;
        &quot;itemGroupId&quot;: 0,&#xd;
        &quot;costCodeId&quot;: 0,&#xd;
        &quot;activityId&quot;: 0,&#xd;
        &quot;projectItemKey&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCartDis&quot;: 0,&#xd;
        &quot;projectItemWbsLevel&quot;: null,&#xd;
        &quot;projectItemStartDate&quot;: null,&#xd;
        &quot;depotId&quot;: null,&#xd;
        &quot;projectItemText&quot;: &quot;&quot;,&#xd;
        &quot;projectItemProdRate&quot;: 1.17,&#xd;
        &quot;projectItemDuration&quot;: null,&#xd;
        &quot;projectItemRateOnlyAmount&quot;: null,&#xd;
        &quot;projectItemProvSumAmount&quot;: null,&#xd;
        &quot;projectItemNonCalculation&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemRateOnly&quot;: &quot;&quot;,&#xd;
        &quot;projectItemIsProvSum&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCalculation&quot;: &quot;3&quot;,&#xd;
        &quot;projectDetail&quot;: {},&#xd;
        &quot;projectItemParentId&quot;: 367667,&#xd;
        &quot;projectItemId&quot;: 1,&#xd;
        &quot;isSubItem&quot;: &quot;n&quot;,&#xd;
        &quot;projectItemAllocateCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcML&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCbs&quot;: &quot;test&quot;,&#xd;
        &quot;unitDescription&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode2&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode3&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode4&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemNotes&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcMax&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCalcMin&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemChanged&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCostOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemInfoProv&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemStemCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemTextOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsClaimed&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsForecast&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsOverhead&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemSpreadType&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemTosFormula&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemDoNotSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCurrencyCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemPricingMethod&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSynchronised&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCompositeType&quot;: 3&#xd;
    },&#xd;
    &quot;aggrDesc&quot;: &quot;Rkitem23&quot;&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages" enabled="true">
                  <stringProp name="JSONPostProcessor.referenceNames">estimateId;errors;title;status;traceId</stringProp>
                  <stringProp name="JSONPostProcessor.jsonPathExprs">$.estimateId;$.errors..*;$.title;$.status;$.traceId</stringProp>
                  <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0;0</stringProp>
                  <stringProp name="Sample.scope">all</stringProp>
                  <stringProp name="Scope.variable"> </stringProp>
                  <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
                </JSONPostProcessor>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper

// Parse response JSON
def response = prev.getResponseDataAsString()
def json = new JsonSlurper().parseText(response)

// Extract values
def estimateId = vars.get(&quot;estimateId&quot;) ?: &quot;NOT_FOUND&quot;
def title = vars.get(&quot;title&quot;) ?: &quot;NOT_FOUND&quot;
def status = vars.get(&quot;status&quot;) ?: &quot;NOT_FOUND&quot;
def traceId = vars.get(&quot;traceId&quot;) ?: &quot;NOT_FOUND&quot;

// Extract error messages as a flat list
def errors = []
if (json.errors) {
    json.errors.each { k, v -&gt;
        v.each { msg -&gt; errors &lt;&lt; &quot;${k}: ${msg}&quot; }
    }
}

// Build log output
def logMsg = &quot;&quot;&quot;
================ Response Validation ================
Title      : ${title}
Status     : ${status}
TraceId    : ${traceId}
Errors     :
${errors.join(&quot;\n&quot;)}
====================================================
&quot;&quot;&quot;

// Log to JMeter GUI and console
log.info(logMsg)
println(logMsg)
</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Normal Item: The projectDetailDTO field &quot;projectItemProdRate&quot; is required">
                <stringProp name="HTTPSampler.path">/api/v2/estimate/create</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">POST</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
    &quot;parentId&quot;: 367667,&#xd;
    &quot;recordType&quot;: 3,&#xd;
    &quot;CarbonData&quot;: {},&#xd;
    &quot;estimateNsetId&quot;: 0,&#xd;
    &quot;estimateId&quot;: 6270,&#xd;
    &quot;projectDetail&quot;: {},&#xd;
    &quot;aggrCode&quot;: &quot;Rkitem23&quot;,&#xd;
    &quot;activityId&quot;: &quot;&quot;,&#xd;
    &quot;projectItem&quot;: {&#xd;
        &quot;projectItemQty&quot;: 3,&#xd;
        &quot;unitId&quot;: 22,&#xd;
        &quot;itemGroupId&quot;: 0,&#xd;
        &quot;costCodeId&quot;: 0,&#xd;
        &quot;activityId&quot;: 0,&#xd;
        &quot;projectItemKey&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCartDis&quot;: 0,&#xd;
        &quot;projectItemWbsLevel&quot;: null,&#xd;
        &quot;projectItemStartDate&quot;: null,&#xd;
        &quot;depotId&quot;: null,&#xd;
        &quot;projectItemText&quot;: &quot;&quot;,&#xd;
        &quot;projectItemProdRate&quot;: ,&#xd;
        &quot;projectItemDuration&quot;: null,&#xd;
        &quot;projectItemRateOnlyAmount&quot;: null,&#xd;
        &quot;projectItemProvSumAmount&quot;: null,&#xd;
        &quot;projectItemNonCalculation&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemRateOnly&quot;: &quot;&quot;,&#xd;
        &quot;projectItemIsProvSum&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCalculation&quot;: &quot;3&quot;,&#xd;
        &quot;projectDetail&quot;: {},&#xd;
        &quot;projectItemParentId&quot;: 367667,&#xd;
        &quot;projectItemId&quot;: 1,&#xd;
        &quot;isSubItem&quot;: &quot;n&quot;,&#xd;
        &quot;projectItemAllocateCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcML&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCbs&quot;: &quot;test&quot;,&#xd;
        &quot;unitDescription&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode2&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode3&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode4&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemNotes&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcMax&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCalcMin&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemChanged&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCostOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemInfoProv&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemStemCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemTextOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsClaimed&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsForecast&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsOverhead&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemSpreadType&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemTosFormula&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemDoNotSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCurrencyCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemPricingMethod&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSynchronised&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCompositeType&quot;: 3&#xd;
    },&#xd;
    &quot;aggrDesc&quot;: &quot;Rkitem23&quot;&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages" enabled="true">
                  <stringProp name="JSONPostProcessor.referenceNames">err_title;err_status;err_traceId;err_errors</stringProp>
                  <stringProp name="JSONPostProcessor.jsonPathExprs">$.title;$.status;$.traceId;$.errors</stringProp>
                  <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0</stringProp>
                  <stringProp name="Sample.scope">all</stringProp>
                  <stringProp name="Scope.variable"> </stringProp>
                  <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
                </JSONPostProcessor>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper

// Get full response
def response = prev.getResponseDataAsString()

if (response) {
    def json = new JsonSlurper().parseText(response)

    // Extract required fields
    def title   = json.title ?: &quot;N/A&quot;
    def status  = json.status ?: &quot;N/A&quot;
    def traceId = json.traceId ?: &quot;N/A&quot;
    def errors  = json.errors ?: [:]

    // Save to JMeter vars
    vars.put(&quot;ERR_TITLE&quot;, title.toString())
    vars.put(&quot;ERR_STATUS&quot;, status.toString())
    vars.put(&quot;ERR_TRACEID&quot;, traceId.toString())
    vars.put(&quot;ERR_ERRORS&quot;, errors.toString())

    // Logging (GUI + Console)
    log.info(&quot;============================================================&quot;)
    log.info(&quot;🔴 VALIDATION ERROR RESPONSE&quot;)
    log.info(&quot; Title   : ${title}&quot;)
    log.info(&quot; Status  : ${status}&quot;)
    log.info(&quot; TraceId : ${traceId}&quot;)
    log.info(&quot; Errors  : ${errors}&quot;)
    log.info(&quot;============================================================&quot;)

    // Console output (non-GUI mode)
    println &quot;================ VALIDATION ERRORS ================&quot;
    println &quot; Title   : ${title}&quot;
    println &quot; Status  : ${status}&quot;
    println &quot; TraceId : ${traceId}&quot;
    println &quot; Errors  : ${errors}&quot;
    println &quot;==================================================&quot;
}
</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Create Normal Item: The projectDetailDTO field &quot;projectItemParentId&quot; is required">
                <stringProp name="HTTPSampler.path">/api/v2/estimate/create</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">POST</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
    &quot;parentId&quot;: 367667,&#xd;
    &quot;recordType&quot;: 3,&#xd;
    &quot;CarbonData&quot;: {},&#xd;
    &quot;estimateNsetId&quot;: 0,&#xd;
    &quot;estimateId&quot;: 6270,&#xd;
    &quot;projectDetail&quot;: {},&#xd;
    &quot;aggrCode&quot;: &quot;Rkitem23&quot;,&#xd;
    &quot;activityId&quot;: &quot;&quot;,&#xd;
    &quot;projectItem&quot;: {&#xd;
        &quot;projectItemQty&quot;: 3,&#xd;
        &quot;unitId&quot;: 22,&#xd;
        &quot;itemGroupId&quot;: 0,&#xd;
        &quot;costCodeId&quot;: 0,&#xd;
        &quot;activityId&quot;: 0,&#xd;
        &quot;projectItemKey&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCartDis&quot;: 0,&#xd;
        &quot;projectItemWbsLevel&quot;: null,&#xd;
        &quot;projectItemStartDate&quot;: null,&#xd;
        &quot;depotId&quot;: null,&#xd;
        &quot;projectItemText&quot;: &quot;&quot;,&#xd;
        &quot;projectItemProdRate&quot;: 1.17,&#xd;
        &quot;projectItemDuration&quot;: null,&#xd;
        &quot;projectItemRateOnlyAmount&quot;: null,&#xd;
        &quot;projectItemProvSumAmount&quot;: null,&#xd;
        &quot;projectItemNonCalculation&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemRateOnly&quot;: &quot;&quot;,&#xd;
        &quot;projectItemIsProvSum&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCalculation&quot;: &quot;3&quot;,&#xd;
        &quot;projectDetail&quot;: {},&#xd;
        &quot;projectItemParentId&quot;: ,&#xd;
        &quot;projectItemId&quot;: 1,&#xd;
        &quot;isSubItem&quot;: &quot;n&quot;,&#xd;
        &quot;projectItemAllocateCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcML&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCbs&quot;: &quot;test&quot;,&#xd;
        &quot;unitDescription&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode2&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode3&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCode4&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemNotes&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemCalcMax&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCalcMin&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemChanged&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCostOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemInfoProv&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemStemCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemTextOnly&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsClaimed&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsForecast&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemIsOverhead&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemSpreadType&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemTosFormula&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemDoNotSpread&quot;: &quot;y&quot;,&#xd;
        &quot;projectItemCurrencyCode&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemPricingMethod&quot;: &quot;test&quot;,&#xd;
        &quot;projectItemIsSynchronised&quot;: &quot;N&quot;,&#xd;
        &quot;projectItemCompositeType&quot;: 3&#xd;
    },&#xd;
    &quot;aggrDesc&quot;: &quot;Rkitem23&quot;&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages" enabled="true">
                  <stringProp name="JSONPostProcessor.referenceNames">errors;title;status;traceId</stringProp>
                  <stringProp name="JSONPostProcessor.jsonPathExprs">$.errors.*;$.title;$.status;$.traceId</stringProp>
                  <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0</stringProp>
                  <stringProp name="Sample.scope">all</stringProp>
                  <stringProp name="Scope.variable"> </stringProp>
                  <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
                </JSONPostProcessor>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper

// Get response body
def response = prev.getResponseDataAsString()

// Try parsing JSON
def json
try {
    json = new JsonSlurper().parseText(response)
} catch(Exception e) {
    log.error(&quot;❌ Invalid JSON response: &quot; + e.message)
    return
}

// Extract values safely
def estimateId = json.estimateId ?: &quot;NOT_FOUND&quot;
def errors = json.errors ?: [:]
def title = json.title ?: &quot;NOT_FOUND&quot;
def status = json.status ?: &quot;NOT_FOUND&quot;
def traceId = json.traceId ?: &quot;NOT_FOUND&quot;

// Log to JMeter GUI + Console
log.info(&quot;============================================================&quot;)
log.info(&quot; Estimate ID : ${estimateId}&quot;)
log.info(&quot; Title       : ${title}&quot;)
log.info(&quot; Status Code : ${status}&quot;)
log.info(&quot; Trace ID    : ${traceId}&quot;)

if(errors) {
    log.info(&quot; Errors:&quot;)
    errors.each { key, msgs -&gt;
        msgs.each { msg -&gt;
            log.info(&quot;   ${key} -&gt; ${msg}&quot;)
        }
    }
} else {
    log.info(&quot; No validation errors found.&quot;)
}
log.info(&quot;============================================================&quot;)

// Store in variables for later use
vars.put(&quot;ESTIMATE_ID&quot;, estimateId.toString())
vars.put(&quot;TITLE&quot;, title.toString())
vars.put(&quot;STATUS_CODE&quot;, status.toString())
vars.put(&quot;TRACE_ID&quot;, traceId.toString())
</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="AutoAllocate - The autoAllocateReq field is required">
                <stringProp name="HTTPSampler.path">/api/v2/estimate/auto-allocate/item-library</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">POST</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&quot;estimateNsetId&quot;:}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages">
                  <stringProp name="JSONPostProcessor.referenceNames">errors;title;status;traceId</stringProp>
                  <stringProp name="JSONPostProcessor.jsonPathExprs">$.errors.*;$.title;$.status;$.traceId</stringProp>
                  <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0</stringProp>
                  <stringProp name="Sample.scope">all</stringProp>
                  <stringProp name="Scope.variable"> </stringProp>
                  <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
                </JSONPostProcessor>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper

// Get sampler response
def response = prev.getResponseDataAsString()

// Try parse JSON
def json
try {
    json = new JsonSlurper().parseText(response)
} catch(Exception e) {
    log.error(&quot;❌ Invalid JSON response: &quot; + e.message)
    return
}

// Extract fields safely
def estimateNsetId = json.estimateNsetId ?: &quot;NOT_FOUND&quot;
def errors = json.errors ?: [:]
def title = json.title ?: &quot;NOT_FOUND&quot;
def status = json.status ?: &quot;NOT_FOUND&quot;
def traceId = json.traceId ?: &quot;NOT_FOUND&quot;

// Log to GUI + Console
log.info(&quot;============================================================&quot;)
log.info(&quot; EstimateNsetId : ${estimateNsetId}&quot;)
log.info(&quot; Title          : ${title}&quot;)
log.info(&quot; Status Code    : ${status}&quot;)
log.info(&quot; Trace ID       : ${traceId}&quot;)

if(errors) {
    log.info(&quot; Errors:&quot;)
    errors.each { key, msgs -&gt;
        msgs.each { msg -&gt;
            log.info(&quot;   ${key} -&gt; ${msg}&quot;)
        }
    }
} else {
    log.info(&quot; No validation errors found.&quot;)
}
log.info(&quot;============================================================&quot;)

// Store in vars for later use
vars.put(&quot;ESTIMATE_NSET_ID&quot;, estimateNsetId.toString())
vars.put(&quot;TITLE&quot;, title.toString())
vars.put(&quot;STATUS_CODE&quot;, status.toString())
vars.put(&quot;TRACE_ID&quot;, traceId.toString())
</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="AutoAllocate - A non-empty request body is required">
                <stringProp name="HTTPSampler.path">/api/v2/estimate/auto-allocate/item-library</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">POST</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
                  <collectionProp name="Arguments.arguments"/>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <JSONPostProcessor guiclass="JSONPostProcessorGui" testclass="JSONPostProcessor" testname="Extract Error/Validation Messages">
                  <stringProp name="JSONPostProcessor.referenceNames">errors;title;status;traceId</stringProp>
                  <stringProp name="JSONPostProcessor.jsonPathExprs">$.errors.*;$.title;$.status;$.traceId</stringProp>
                  <stringProp name="JSONPostProcessor.match_numbers">0;0;0;0</stringProp>
                  <stringProp name="Sample.scope">all</stringProp>
                  <stringProp name="Scope.variable"> </stringProp>
                  <stringProp name="JSONPostProcessor.defaultValues">NOT_FOUND;NOT_FOUND;NOT_FOUND;NOT_FOUND</stringProp>
                </JSONPostProcessor>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper

// Get sampler response
def response = prev.getResponseDataAsString()

// Try parse JSON
def json
try {
    json = new JsonSlurper().parseText(response)
} catch(Exception e) {
    log.error(&quot;❌ Invalid JSON response: &quot; + e.message)
    return
}

// Extract values
def errors = json.errors ?: [:]
def title = json.title ?: &quot;NOT_FOUND&quot;
def status = json.status ?: &quot;NOT_FOUND&quot;
def traceId = json.traceId ?: &quot;NOT_FOUND&quot;

// Structured Logging
log.info(&quot;============================================================&quot;)
log.info(&quot; Title       : ${title}&quot;)
log.info(&quot; Status Code : ${status}&quot;)
log.info(&quot; Trace ID    : ${traceId}&quot;)

if(errors) {
    log.info(&quot; Errors:&quot;)
    errors.each { key, msgs -&gt;
        def errorKey = key?.trim() ? key : &quot;(empty key)&quot;
        msgs.each { msg -&gt;
            log.info(&quot;   ${errorKey} -&gt; ${msg}&quot;)
        }
    }
} else {
    log.info(&quot; No validation errors found.&quot;)
}
log.info(&quot;============================================================&quot;)

// Store in vars for later use
vars.put(&quot;TITLE&quot;, title.toString())
vars.put(&quot;STATUS_CODE&quot;, status.toString())
vars.put(&quot;TRACE_ID&quot;, traceId.toString())
</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Get Estimate View">
                <stringProp name="HTTPSampler.path">/api/v2/estimate/estimate-view</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">POST</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
    &quot;projectId&quot;: ${__V(child_${childIndex}_estimateNsetId)},&#xd;
    &quot;offset&quot;: ${projectLeftValue},&#xd;
    &quot;recordsPerPage&quot;: 1,&#xd;
    &quot;direction&quot;: &quot;forward&quot;,&#xd;
    &quot;aggregateLevel&quot;: &quot;section&quot;,&#xd;
    &quot;expandedList&quot;: [ ${projectCarbonEstimateNsetId}]&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree/>
            </hashTree>
          </hashTree>
          <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Delete Section" enabled="false"/>
          <hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Delete Section" enabled="true">
              <stringProp name="HTTPSampler.path">/api/v2/estimate/delete/${projectDetailId}</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">DELETE</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
                <collectionProp name="Arguments.arguments"/>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree/>
          </hashTree>
        </hashTree>
        <ResultCollector guiclass="ViewResultsFullVisualizer" testclass="ResultCollector" testname="View Results Tree">
          <boolProp name="ResultCollector.error_logging">false</boolProp>
          <objProp>
            <name>saveConfig</name>
            <value class="SampleSaveConfiguration">
              <time>true</time>
              <latency>true</latency>
              <timestamp>true</timestamp>
              <success>true</success>
              <label>true</label>
              <code>true</code>
              <message>true</message>
              <threadName>true</threadName>
              <dataType>true</dataType>
              <encoding>false</encoding>
              <assertions>true</assertions>
              <subresults>true</subresults>
              <responseData>false</responseData>
              <samplerData>false</samplerData>
              <xml>false</xml>
              <fieldNames>true</fieldNames>
              <responseHeaders>false</responseHeaders>
              <requestHeaders>false</requestHeaders>
              <responseDataOnError>false</responseDataOnError>
              <saveAssertionResultsFailureMessage>true</saveAssertionResultsFailureMessage>
              <assertionsResultsToSave>0</assertionsResultsToSave>
              <bytes>true</bytes>
              <sentBytes>true</sentBytes>
              <url>true</url>
              <threadCounts>true</threadCounts>
              <idleTime>true</idleTime>
              <connectTime>true</connectTime>
            </value>
          </objProp>
          <stringProp name="filename"></stringProp>
        </ResultCollector>
        <hashTree/>
      </hashTree>
    </hashTree>
  </hashTree>
</jmeterTestPlan>
